(function(){var e={2006:function(e,t,n){"use strict";var o=n(7663),a=n(5414),s=n(437),l=n(7127),r=n(5705),i=n(1133),d=(n(6416),n(8084)),c=n(5185);function u(){return(0,c.Z)()}const g={appearance:{x:0,y:0,width:100,height:100},gd:{type:"notice",content:null,variable:null}};class h{constructor(e){"undefined"==typeof e.id&&(e.id=u()),Object.assign(this,g,e)}is_node(){return!0}is_edge(){return!1}get_label(){return this.gd.variable??this.gd.content??`${this.gd.type}_${this.id.toString().substring(0,8)}`}get_variable(){return this.gd.variable??`${this.gd.type}_${this.id.toString().substring(0,8)}`}get_edges_in(){return this.graph.edges.filter((e=>e.node_to_id==this.id))}get_edges_out(){return this.graph.edges.filter((e=>e.node_from_id==this.id))}get_nodes_in(){const e=this.get_edges_in().map((e=>e.node_from_id))??[];return this.graph.nodes.filter((t=>e.includes(t.id)))}get_nodes_out(){const e=this.get_edges_out().map((e=>e.node_to_id))??[];return this.graph.nodes.filter((t=>e.includes(t.id)))}}const p={gd:{content:null}};class m{constructor(e){e.id=e.id??u(),Object.assign(this,p,e)}is_node(){return!1}is_edge(){return!0}get_node_from(){return this.graph.nodes.filter((e=>e.id==this.node_from_id))[0]}get_node_to(){return this.graph.nodes.filter((e=>e.id==this.node_to_id))[0]}}class b{constructor(e="Untitled graph"){(0,d.Z)(this,"name",void 0),(0,d.Z)(this,"nodes",[]),(0,d.Z)(this,"edges",[]),this.name=e}get_nodes_by_type(e){return this.nodes.filter((t=>t.gd.type==e))??[]}add_node(e){this.nodes.push(new h({...e,graph:this}))}add_edge(e){this.edges.push(new m({...e,graph:this}))}clear(){this.nodes=[],this.edges=[]}}var _=b;const f=(e="")=>null==e?null:{attrs:{text:{text:e}},position:{distance:.4}},v={attrs:{line:{strokeWidth:"1"}},zIndex:-1},y={grid:!0,background:{color:"white"},mousewheel:{enabled:!0,zoomAtMousePosition:!0,modifiers:"ctrl",minScale:.5,maxScale:3},scroller:{enabled:!0,pannable:!0},connecting:{allowBlank:!1,allowMulti:!1,allowLoop:!1,allowEdge:!1,allowNode:!1,allowPort:!0,highlight:!0,snap:!0,connector:"algo-connector",connectionPoint:"boundary",anchor:"top",validateMagnet({e:e,magnet:t,view:n,cell:o}){return"in"!==t.getAttribute("port-group")},createEdge(){return this.createEdge(v)},validateEdge({edge:e,type:t,previous:n}){return!0},validateConnection({edge:e,sourceMagnet:t,targetMagnet:n}){return null!=t&&null!=n&&("out"==t.getAttribute("port-group")&&"in"==n.getAttribute("port-group"))}},history:{enabled:!0,beforeAddCommand(e,t){if("tools"==t.key)return!1}},resizing:{enabled:!1},selecting:{enabled:!0,multiple:!1}};function w(e){e.on("node:mouseenter",(({cell:e})=>{e.addTools([{name:"button-remove"}])})),e.on("node:mouseleave",(({cell:e})=>{setTimeout((()=>{e.removeTool("button-remove")}),1e3)})),i.kJ.registerConnector("algo-connector",((e,t)=>{const n=4,o=Math.abs(t.y-e.y),a=Math.floor(o/3*2),s={x:e.x,y:e.y+n+a},l={x:t.x,y:t.y-n-a};return i.y$.normalize(`M ${e.x} ${e.y}\n            L ${e.x} ${e.y+n}\n            C ${s.x} ${s.y} ${l.x} ${l.y} ${t.x} ${t.y-n}\n            L ${t.x} ${t.y}\n            `)}),!0)}const x={in:{attrs:{circle:{r:6,stroke:"#6a6a6b",magnet:!0}},position:"top"},out:{attrs:{circle:{r:6,stroke:"#6a6a6b",magnet:!0}},position:"bottom"}};function k(e){const t={groups:x,items:[]};for(const n of e)t.items.push({id:`${n}-1`,group:n});return t}const C="notice",D={render(e){const t=e.getData();let n="",o="";return t.gd.variable?(n=t.gd.variable,o="node-label-variable"):t.gd.content?(n=`"${t.gd.content}"`,o="node-label-content"):t.is_stencil_node?(n=`new ${t.gd.type} node`,o="node-label-unnamed"):(n=`${t.gd.type}_${e.id.toString().substring(0,8)}`,o="node-label-unnamed"),`<div class="node node-${t.gd.type} ${t.errors?"node-has-errors":""}">\n                <span class="${o}">${n}</span>\n            </div>`},shouldComponentUpdate(e){return e.hasChanged("data")}},j={start:{antv_metadata:{shape:"html",html:D,width:180,height:36,data:{gd:Object.assign({},g.gd,{type:"start"})},ports:k(["out"])},config_fields:{general:["variable","label"],additional:[]}},decision:{antv_metadata:{shape:"html",html:D,width:180,height:36,data:{gd:Object.assign({},g.gd,{type:"decision"})},ports:k(["in","out"])},config_fields:{general:["variable","label"],additional:[]}},notice:{antv_metadata:{shape:"html",html:D,width:180,height:36,data:{gd:Object.assign({},g.gd,{type:"notice"})},ports:k(["in","out"])},config_fields:{general:["variable","label"],additional:[]}},end:{antv_metadata:{shape:"html",html:D,width:180,height:36,data:{gd:Object.assign({},g.gd,{type:"end"})},ports:k(["in"])},config_fields:{general:["variable","label"]}}};class O{constructor(e,t){(0,d.Z)(this,"data",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"is_open",(0,l.iH)(!1)),this.data=e?(0,l.qj)(e):(0,l.qj)({}),this.events={...t}}open(){this.is_open.value=!0,this.events.onOpen&&this.events.onOpen()}close(){this.is_open.value=!1,this.events.onClose&&this.events.onClose()}}const S=e=>((0,a.dD)("data-v-608b8ee0"),e=e(),(0,a.Cn)(),e),$=S((()=>(0,a._)("div",{class:"modal-bg fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1))),U={class:"fixed z-20 inset-0 overflow-y-auto"},E={class:"flex items-end sm:items-center justify-center min-h-full p-4 text-center"};var A=(0,a.aZ)({__name:"ModalComponent",props:{modal:{},container_style:{}},setup(e){const t=e;let n=!1;const l=e=>{const t=e.target,o=document.querySelector(".modal-container");n=null!=o&&!o.contains(t)},r=e=>{if(n){const n=e.target,o=document.querySelector(".modal-container");null==o||o.contains(n)||t.modal.close()}};return(e,n)=>((0,a.wg)(),(0,a.j4)(a.lR,{to:"body"},[(0,a.Wm)(o.uT,{name:"modal-transition",appear:""},{default:(0,a.w5)((()=>[t.modal.is_open.value?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"relative z-10","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",onKeydown:n[0]||(n[0]=(0,o.D2)((e=>t.modal.close()),["esc"])),tabindex:"0",onMousedown:l,onMouseup:r},[$,(0,a._)("div",U,[(0,a._)("div",E,[(0,a._)("div",{class:"modal-container relative bg-white rounded-lg text-left overflow-hidden shadow-xl sm:my-8 sm:max-w-md sm:w-full",style:(0,s.j5)(t.container_style??{})},[(0,a.WI)(e.$slots,"default")],4)])])],32)):(0,a.kq)("",!0)])),_:3})]))}}),H=n(2830);const M=(0,H.Z)(A,[["__scopeId","data-v-608b8ee0"]]);var N=M,P=n(8223),T=n.n(P),I=(0,a.aZ)({__name:"EasymdeView",props:{options:{},value:{}},emits:["change","input"],setup(e,{emit:t}){const n=e,o=t,s=(0,l.iH)(null),r=(0,l.iH)(null);return(0,a.bv)((()=>{if(null!=r.value){const e={element:r.value,initialValue:n.value,spellChecker:!1,...n.options};s.value=new(T())(e),s.value.codemirror.on("change",((...e)=>{o("change",s.value,...e),o("input",s.value?.value())}))}})),(0,a.Ah)((()=>{null!==s.value&&s.value.cleanup()})),(e,t)=>((0,a.wg)(),(0,a.iD)("textarea",{ref_key:"editorRef",ref:r},null,512))}});const L=I;var Z=L,Y=Z;const q=e=>((0,a.dD)("data-v-2cb326fd"),e=e(),(0,a.Cn)(),e),z={key:0},R=q((()=>(0,a._)("span",{class:"block p-2 text-gray-700"},"Select a node or edge to configure",-1))),B=[R],G={key:1,class:"w-full p-3"},V={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},J={class:"mt-3 text-center sm:mt-0 sm:text-left"},F=q((()=>(0,a._)("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},"Edit content",-1))),W={class:"mt-2"},K={class:"text-sm text-gray-500"},X=q((()=>(0,a._)("a",{href:"https://commonmark.org/help/",target:"_blank"},"markdown",-1))),Q=q((()=>(0,a._)("p",{class:"text-sm text-gray-500 mt-1"},[(0,a.Uk)(" Docassmble uses Mako as a templating system, to allow for including variables and code in content. More on how to use this at "),(0,a._)("a",{href:"https://docassemble.org/docs/markup.html#mako",target:"_blank"},"Docassemble"),(0,a.Uk)(". ")],-1))),ee=q((()=>(0,a._)("p",{class:"text-sm text-gray-500 mt-1"},[(0,a.Uk)(" Note that when referencing a variable, even in an 'if' statement, the block corresponding to the variable will be first shown to the user (regardless of the order specified in the graph). To show a variable only when it is defined, one can use the "),(0,a._)("span",{class:"code text-gray-700"},"defined('variable')"),(0,a.Uk)(" function within Mako, as described at "),(0,a._)("a",{href:"https://docassemble.org/docs/markup.html#mako",target:"_blank"},"Docassemble"),(0,a.Uk)(". ")],-1))),te={class:"mt-4"},ne={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},oe={class:""},ae={class:"mb-2 text-ellipsis overflow-hidden font-mono block text-xl border-b border-gray-300"},se={class:"w-full"},le=q((()=>(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1))),re=[le],ie={class:"my-2"},de={class:"mt-1 mb-3 block border-b border-gray-300 text-lg leading-6 font-medium text-gray-800"},ce={key:0},ue=q((()=>(0,a._)("span",{class:"text-gray-700 block mb-1 text-sm"},"Variable",-1))),ge=["placeholder"],he={key:1},pe={class:"flex justify-between items-center mb-1"},me=q((()=>(0,a._)("label",{class:"text-gray-700 block text-sm",for:"textarea_content"},"Content",-1))),be=q((()=>(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1))),_e=[be],fe={key:2,class:"w-full p-2"},ve={class:""},ye=q((()=>(0,a._)("span",{class:"mb-2 font-bold block text-2xl border-b border-gray-300"},"Edge",-1))),we=q((()=>(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1))),xe=[we],ke={key:0,class:"my-2"},Ce=q((()=>(0,a._)("span",{class:"my-2 block border-b border-gray-300 uppercase font-bold text-sm text-gray-800"},"General",-1))),De={class:"block mt-2"},je=q((()=>(0,a._)("span",{class:"text-gray-700 block mb-1"},"Label",-1))),Oe={class:"w-full my-2 text-right"},Se={key:3},$e=q((()=>(0,a._)("span",null,"Invalid cell selected",-1))),Ue=[$e];var Ee=(0,a.aZ)({__name:"GraphModelerConfigBar",props:{cell:{}},setup(e){const t=e,n=new O({read_more:!1,editor:""},{onOpen:()=>{n.data.editor=c.value}}),r=e=>{c.value=e.data.editor,e.close()},i=(0,a.Fl)((()=>{const e=t.cell?.getData()?.node_type??C;let n=null;return n=Object.keys(j).includes(e)?j[e].config_fields:j[C].config_fields,Object.fromEntries(Object.entries(n).filter((([e,t])=>t.length>0)))})),d=(0,l.iH)(""),c=(0,a.Fl)({get(){return d.value,t.cell.getData().gd.content??""},set(e){d.value=e,t.cell.setData({gd:{content:e}})}}),u=(0,l.iH)(""),g=(0,a.Fl)({get(){return u.value,t.cell.getData().gd.variable??""},set(e){u.value=e,t.cell.setData({gd:{variable:""!=e?e:null}})}}),h=(0,l.iH)(""),p=(0,a.Fl)({get(){const e=t.cell;return h.value,e.getLabelAt(0)?.attrs?.text?.text?.toString()??""},set(e){const n=t.cell,o=f(e);null!=o&&(n.removeLabelAt(0),n.setLabelAt(0,o)),h.value=e,n.setData({value:e})}});return(e,t)=>null==e.cell?((0,a.wg)(),(0,a.iD)("div",z,B)):e.cell.isNode()?((0,a.wg)(),(0,a.iD)("div",G,[(0,l.SU)(n).is_open?((0,a.wg)(),(0,a.j4)(N,{key:0,modal:(0,l.SU)(n),container_style:{"max-width":"48rem"}},{default:(0,a.w5)((()=>[(0,a._)("div",V,[(0,a._)("div",J,[F,(0,a._)("div",W,[(0,a._)("p",K,[(0,a.Uk)(" You can use "),X,(0,a.Uk)(" to add styles to the content displayed for this node. Text containing HTML code will be rendered as HTML. "),(0,a._)("span",{class:"ml-1 text-sm text-gray-800 cursor-pointer select-none hover:text-gray-700 hover:underline",onClick:t[0]||(t[0]=e=>(0,l.SU)(n).data.read_more=!(0,l.SU)(n).data.read_more)},(0,s.zw)((0,l.SU)(n).data.read_more?"less":"more"),1)]),(0,l.SU)(n).data.read_more?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[Q,ee],64)):(0,a.kq)("",!0)]),(0,a._)("div",te,[(0,a.Wm)((0,l.SU)(Y),{options:{},value:(0,l.SU)(n).data.editor,onInput:t[1]||(t[1]=e=>(0,l.SU)(n).data.editor=e)},null,8,["value"])])])]),(0,a._)("div",ne,[(0,a._)("button",{onClick:t[2]||(t[2]=e=>r((0,l.SU)(n))),type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"},"Accept"),(0,a._)("button",{onClick:t[3]||(t[3]=e=>(0,l.SU)(n).close()),type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"},"Cancel")])])),_:1},8,["modal"])):(0,a.kq)("",!0),(0,a._)("div",oe,[(0,a._)("span",ae,(0,s.zw)(e.cell.getData().gd.variable??`${e.cell.getData().gd.type}_${e.cell.id.toString().substring(0,8)}`),1),(0,a._)("div",se,[(0,a._)("button",{onClick:t[4]||(t[4]=t=>e.cell?.remove()),class:"btn btn-red"},re)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.value,((r,i)=>((0,a.wg)(),(0,a.iD)("div",{key:i},[(0,a._)("div",ie,[(0,a._)("span",de,(0,s.zw)(i.toString()[0].toUpperCase().concat(i.toString().substring(1))),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r,(s=>((0,a.wg)(),(0,a.iD)("div",{key:s,class:"block mt-2 mb-1"},["variable"==s?((0,a.wg)(),(0,a.iD)("label",ce,[ue,(0,a._)("div",null,[(0,a.wy)((0,a._)("input",{class:"style-soft w-full font-mono",type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>g.value=e),placeholder:`${e.cell.getData().gd.type}_${e.cell.id.toString().substring(0,8)}`},null,8,ge),[[o.nr,g.value]])])])):(0,a.kq)("",!0),"label"==s?((0,a.wg)(),(0,a.iD)("div",he,[(0,a._)("div",pe,[me,(0,a._)("button",{class:"btn text-sm",onClick:t[6]||(t[6]=e=>(0,l.SU)(n).open())},_e)]),(0,a._)("div",null,[(0,a.wy)((0,a._)("textarea",{id:"textarea_content",style:{"min-height":"4rem"},class:"w-full style-soft",type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>c.value=e)},null,512),[[o.nr,c.value]])])])):(0,a.kq)("",!0)])))),128))])])))),128))])])):e.cell.isEdge()?((0,a.wg)(),(0,a.iD)("div",fe,[(0,a._)("div",ve,[ye,(0,a._)("div",null,[(0,a._)("button",{onClick:t[8]||(t[8]=t=>e.cell?.remove()),class:"btn btn-red"},xe)]),"decision"==e.cell.getSourceCell()?.getData().gd.type?((0,a.wg)(),(0,a.iD)("div",ke,[Ce,(0,a._)("div",De,[(0,a._)("label",null,[je,(0,a.wy)((0,a._)("input",{type:"text",class:"style-soft w-full","onUpdate:modelValue":t[9]||(t[9]=e=>p.value=e)},null,512),[[o.nr,p.value]])]),(0,a._)("div",Oe,[(0,a._)("button",{class:"inline btn mr-2",onClick:t[10]||(t[10]=e=>p.value="Yes")},"Yes"),(0,a._)("button",{class:"inline btn",onClick:t[11]||(t[11]=e=>p.value="No")},"No")])])])):(0,a.kq)("",!0)])])):((0,a.wg)(),(0,a.iD)("div",Se,Ue))}});const Ae=(0,H.Z)(Ee,[["__scopeId","data-v-2cb326fd"]]);var He=Ae;const Me={class:"shape-holder"},Ne=["data-type"];var Pe=(0,a.aZ)({__name:"GraphModelerElementsBar",props:{graph:{}},setup(e){const t=e,n=(0,l.iH)();(0,a.bv)((()=>{})),(0,a.YP)((()=>t.graph),(e=>{"undefined"!==typeof e&&o(e)}));const o=e=>{n.value=new i.e9.q6({target:e,scaled:!1,animation:!0,validateNode(e){return e.updateData({is_stencil_node:void 0}),!0}})},r=e=>{if("undefined"==typeof t.graph)return!1;const o=e.currentTarget,a=o.getAttribute("data-type");if(!(a in j))return!1;const s=t.graph.createNode(j[a].antv_metadata);s.setData({label:a,is_stencil_node:!0}),n.value?.start(s,e)};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",Me,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,l.SU)(j),((e,n)=>((0,a.wg)(),(0,a.iD)("div",{key:n,class:(0,s.C_)(`node node-${n}`),"data-type":n,onMousedown:t[0]||(t[0]=e=>r(e))},(0,s.zw)(n),43,Ne)))),128))]))}});const Te=Pe;var Ie=Te;function Le(e,t=1,n=2){return e.map((e=>" ".repeat(2*t).concat(e)))}class Ze{validate_graph(e){const t=[],n=e.get_nodes_by_type("start");1!==n.length&&t.push([`graph must have exactly one start node (has ${n.length})`]);const o=e.get_nodes_by_type("end");0===o.length&&t.push(["graph must have atleast one end node"]);const a={};for(const l of e.nodes){const e=this.da_node_get_variable(l);e in a?(a[e].amount+=1,a[e].nodes.push(l)):a[e]={amount:1,nodes:[l]},"start"==l.gd.type&&1!==l.get_edges_out().length?t.push(["start node ",l,` must have 1 outgoing edge (has ${l.get_edges_out().length})`]):"decision"==l.gd.type&&0===l.get_edges_in().length?t.push(["decision node ",l," must have atleast one ingoing edge"]):"decision"==l.gd.type&&0===l.get_edges_out().length?t.push(["decision node ",l," must have atleast one outgoing edge"]):"notice"==l.gd.type&&0===l.get_edges_in().length?t.push(["notice node ",l," must have atleast one ingoing edge"]):"notice"==l.gd.type&&1!==l.get_edges_out().length?t.push(["notice node ",l," must have one outgoing edge"]):"end"==l.gd.type&&0===l.get_edges_in().length&&t.push(["end node ",l," must have atleast one ingoing edge"])}for(const[l,{amount:r,nodes:i}]of Object.entries(a)){const e=[];i.forEach(((t,n)=>{e.push(t),n<i.length-1&&e.push(", ")})),l.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)||t.push([`invalid (python) variable name '${l}' on the node(s): `,...e]),r>1&&t.push([`variable name '${l}' occurs is defined more than once, in the nodes: `,...e])}const s=e.get_nodes_by_type("decision");for(const l of s){let e=!1;const n={},o=l.get_edges_out();for(const t of o)null==t.gd.content&&(e=!0),null!=t.gd.content&&(n[t.gd.content]=n[t.gd.content]+1||1);e&&t.push(["decision node ",l," has atleast one outgoing edge with no content"]),Object.entries(n).forEach((([e,n])=>{if(n>1){const n=o.filter((t=>t.gd.content=e)),a=["the decision node ",l,` has multiple edges with content '${n[0].gd.content}' on the edges: `];n.forEach(((e,t)=>{a.push(e),t<n.length-1&&a.push(", ")})),t.push(a)}}))}if(0===t.length){const n=[],o=e.nodes.filter((e=>0===e.get_edges_in().length));let a=[...e.edges];while(o.length>0){const e=o.pop();n.push(e);for(const t of a.filter((t=>t.node_from_id==e.id))){const e=t.get_node_to();a=a.filter((e=>!(e.id==t.id))),0===a.filter((t=>t.node_to_id==e.id)).length&&o.push(e)}}a.length>0&&t.push(["graph must not contain cycles/loops"])}return t}da_node_get_variable(e){return e.get_variable()}da_node_escaped_markdown(e){if(!e.gd.content)return`'[content of node ${e.id.substring(0,8)}]'`;const t=e.gd.content.split(/\r?\n/),n=[];for(const o of t)n.push(`${o}`);return"|\n".concat(Le(n).join("\n"))}da_build_logic(e,t){const n=t.get_edges_out(),o=[];switch(t.gd.type){case"start":o.push(this.da_node_get_variable(t));for(const t of n)o.push(...this.da_build_logic(e,t.get_node_to()));break;case"end":o.push(`${this.da_node_get_variable(t)}`);break;case"decision":for(const a of n){const n=a.gd.content;if(null==n)continue;const s=this.da_build_logic(e,a.get_node_to());o.push(`if ${this.da_node_get_variable(t)} == '${a.gd.content}':`),o.push(...Le(s||["pass"],1))}break;case"notice":o.push(`${this.da_node_get_variable(t)}`);for(const t of n)o.push(...this.da_build_logic(e,t.get_node_to()));break}return o}out(e){const t=e.get_nodes_by_type("start")[0],n=(e.get_nodes_by_type("end"),[]);for(const s of e.nodes)switch(s.gd.type){case"start":n.push(["question: Start",`subquestion: ${this.da_node_escaped_markdown(s)}`,`continue button field: ${this.da_node_get_variable(s)}`]);break;case"end":n.push([`event: ${this.da_node_get_variable(s)}`,"question: End",`subquestion: ${this.da_node_escaped_markdown(s)}`]);break;case"decision":{const t=e.edges.filter((e=>e.node_from_id==s.id));let o=[];for(const e of t)null!=e.gd.content&&o.push(`  - "${e.gd.content}"`);o.sort(),o.length>0&&(o=["buttons:",...o]),n.push(["question: Question",`subquestion: ${this.da_node_escaped_markdown(s)}`,`field: ${this.da_node_get_variable(s)}`,...o]);break}case"notice":n.push(["question: Notice",`subquestion: ${this.da_node_escaped_markdown(s)}`,`continue button field: ${this.da_node_get_variable(s)}`]);break}const o=[];o.push(...Le(this.da_build_logic(e,t))),o.length>0&&n.push(["mandatory: True","code: |",...o]);let a=n.map((e=>"string"==typeof e?e:Array.isArray(e)?e.join("\n"):void 0)).join("\n---\n");return a}}class Ye{in(e,t){e.clear();const n={nodes:t.getNodes(),edges:t.getEdges()};for(const o of n.nodes){const t=o.getData(),n={id:o.id,gd:t.gd,appearance:{x:o.getPosition().x??0,y:o.getPosition().y??0,width:o.getSize().width??j[t.gd.type].antv_metadata.width,height:o.getSize().height??j[t.gd.type].antv_metadata.height}};e.add_node(n)}for(const o of n["edges"]){if(null==o.getSourceCell()||null==o.getTargetCell())continue;let t=o.getLabelAt(0)?.attrs?.text?.text?.toString()??null;""==t&&(t=null);const n={id:o.id,node_from_id:o.getSourceCellId(),node_to_id:o.getTargetCellId(),gd:{content:t},appearance:{vertices:o.getVertices()}};e.add_edge(n)}return e}out(e){const t=[];let n=0;Object.values(e.nodes).forEach((e=>{let o={...j[e.gd.type].antv_metadata,id:e.id,x:e.appearance?.x??(n+=50),y:e.appearance?.y??50,data:{gd:e.gd}};o=Object.assign({},j[e.gd.type].antv_metadata??j.notice.antv_metadata??{},o),t.push(o)}));const o=[];Object.values(e.edges).forEach((e=>{const t=f(e.gd.content),n={...v,id:e.id,labels:null!=t?[t]:[],source:{cell:e.node_from_id,port:"out-1"},target:{cell:e.node_to_id,port:"in-1"},data:{gd:e.gd}};o.push(n)}));const a={nodes:t,edges:o};return a}}function qe(e,...t){const n={};return t.forEach((t=>{n[t]=e[t]})),n}class ze{in_json(e,t){e.clear(),e.name=t.main.name;for(const n of t.nodes)e.add_node(n);for(const n of t.edges)e.add_edge(n);return e}out_json(e){const t={nodes:e.nodes.map((e=>qe(e,"id","appearance","gd"))),edges:e.edges.map((e=>qe(e,"id","node_from_id","node_to_id","gd"))),main:{name:e.name}};return t}}var Re=class{constructor(e){(0,d.Z)(this,"graph",void 0),(0,d.Z)(this,"json",void 0),(0,d.Z)(this,"antvis",void 0),(0,d.Z)(this,"docassemble",void 0),this.graph=e??new _,this.json=new ze,this.antvis=new Ye,this.docassemble=new Ze}in_json(e){return this.graph=this.json.in_json(this.graph,e),this}out_json(){return this.json.out_json(this.graph)}in_antv(e){return this.graph=this.antvis.in(this.graph,e),this}out_antv(){return this.antvis.out(this.graph)}out_docassemble(){return this.docassemble.out(this.graph)}};const Be={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ge={class:"sm:flex sm:items-start"},Ve=(0,a._)("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10"},[(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a._)("path",{class:"stroke-blue-900","stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})])],-1),Je={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Fe=(0,a._)("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},"Import",-1),We=(0,a._)("p",{class:"mt-2 text-sm text-gray-500"},"Paste the data of the exported interview below.",-1),Ke={class:"block mt-2 text-sm text-gray-500"},Xe={class:"text-sm cursor-pointer text-gray-800 bg-gray-100 hover:bg-gray-200 border border-gray-400 py-0.5 px-1 mx-0.5 rounded-md"},Qe=(0,a._)("span",null,"upload a file",-1),et={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},tt={class:"toolbar"},nt={class:"toolbar-item"},ot=["disabled"],at={class:"toolbar-item"},st=["disabled"],lt={class:"toolbar-item"},rt=["disabled"],it={class:"toolbar-item"},dt=["disabled"],ct={class:"toolbar-item"},ut=["disabled"];var gt=(0,a.aZ)({__name:"GraphModelerToolbar",props:{graph:{type:i.kJ},docassemble_cont_update:{type:Function},init_modeler:{type:Function}},setup(e){const t=(0,r.pm)(),n=(0,l.iH)(null),s=new O({text:""},{onOpen:()=>{(0,a.Y3)((()=>{n.value?.focus()}))},onClose:()=>s.data.text=""}),i=e=>{var t=new FileReader;t.onload=e=>{e.target?.result&&"string"===typeof e.target?.result&&(s.data.text=e.target?.result)};const n=e.target;null!=n.files&&t.readAsText(n.files[0])},d=()=>{let e=s.data.text;if(0==e.length)return void t.error("No import data is empty");const n=e.match(/\[START INLINE GRAPHDOC EXPORT\].{0,5}(\{.*\}).{0,5}?\[END INLINE GRAPHDOC EXPORT\]/s);n&&n[1]&&(e=n[1]);let o={};try{if(o=JSON.parse(e),!o)throw Error()}catch(l){return void t.error("Data does not contain valid JSON, or does not contain the GraphDoc boundary specifier.")}if(!Object.hasOwnProperty.call(o,"main")||!Object.hasOwnProperty.call(o,"nodes")||!Object.hasOwnProperty.call(o,"edges"))return void t.error("Data does not include one of the required properties: 'main', 'nodes' or 'edges'.");const a=(new Re).in_json(o).out_antv();c.graph?.fromJSON(a),c.docassemble_cont_update(),t.success("Imported"),s.close()},c=e,u=()=>{if(confirm("Are you sure you want to load the example flowchart?")){const e={nodes:[{id:"9ed5d853-62a0-4395-afb9-d94e8cffd2cd",appearance:{x:270,y:40,width:180,height:36},gd:{type:"start",content:"walk or bus?",variable:"walk_or_bus"}},{id:"b8bdd58d-ab1f-44d0-82b8-5edb21f3d484",appearance:{x:270,y:110,width:180,height:36},gd:{type:"decision",content:"is it raining?",variable:"is_raining"}},{id:"396a3b5e-a0cd-49c4-96c3-c65a8da0c483",appearance:{x:90,y:190,width:180,height:36},gd:{type:"notice",content:"take an umbrella",variable:"notice_take_umbrella"}},{id:"d9a60522-cc80-40bf-b691-5e51b27b0e6c",appearance:{x:90,y:260,width:180,height:36},gd:{type:"end",content:"take the bus",variable:"end_bus"}},{id:"20e3d21e-0799-4de7-8d1e-6cac260279ad",appearance:{x:470,y:260,width:180,height:36},gd:{type:"end",content:"take a walk",variable:"end_walk"}}],edges:[{id:"5106836e-d49c-4d33-9ed4-c6b5048ee11f",node_from_id:"b8bdd58d-ab1f-44d0-82b8-5edb21f3d484",node_to_id:"396a3b5e-a0cd-49c4-96c3-c65a8da0c483",gd:{content:"Yes"}},{id:"b81563a8-ad65-4d7e-86df-efbb0cf7fad4",node_from_id:"b8bdd58d-ab1f-44d0-82b8-5edb21f3d484",node_to_id:"20e3d21e-0799-4de7-8d1e-6cac260279ad",gd:{content:"No"}},{id:"3008df09-bacb-4a33-9b3e-8e248e858c2b",node_from_id:"396a3b5e-a0cd-49c4-96c3-c65a8da0c483",node_to_id:"d9a60522-cc80-40bf-b691-5e51b27b0e6c",gd:{content:null}},{id:"90c865d8-fbc3-4b7b-b0a3-46a8f1468c3e",node_from_id:"9ed5d853-62a0-4395-afb9-d94e8cffd2cd",node_to_id:"b8bdd58d-ab1f-44d0-82b8-5edb21f3d484",gd:{content:null}}],main:{name:"Untitled graph"}},t=(new Re).in_json(e).out_antv();c.graph?.fromJSON(t),c.docassemble_cont_update()}},g=()=>{c.graph?.undo()},h=()=>{c.graph?.redo()},p=()=>{confirm("Are you sure you want to reset your workspace?")&&c.graph?.removeCells(c.graph.getCells())};return(t,r)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,l.SU)(s).is_open?((0,a.wg)(),(0,a.j4)(N,{key:0,modal:(0,l.SU)(s),container_style:{"max-width":"30rem"}},{default:(0,a.w5)((()=>[(0,a._)("div",Be,[(0,a._)("div",Ge,[Ve,(0,a._)("div",Je,[Fe,We,(0,a.wy)((0,a._)("textarea",{placeholder:"Paste the contents of the interview here",ref_key:"el_modal_import_text",ref:n,"onUpdate:modelValue":r[0]||(r[0]=e=>(0,l.SU)(s).data.text=e),class:"mt-2 w-full px-4 py-3 text-xs bg-gray-50 break-all font-mono resize-none h-20 leading-5 border border-gray-200 hover:shadow rounded-md"},"\n                ",512),[[o.nr,(0,l.SU)(s).data.text]]),(0,a._)("span",Ke,[(0,a.Uk)("or "),(0,a._)("label",Xe,[Qe,(0,a._)("input",{type:"file",class:"hidden",onChange:i},null,32)]),(0,a.Uk)(" instead.")])])])]),(0,a._)("div",et,[(0,a._)("button",{onClick:r[1]||(r[1]=e=>d()),type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Import"),(0,a._)("button",{onClick:r[2]||(r[2]=e=>(0,l.SU)(s).close()),type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel")])])),_:1},8,["modal"])):(0,a.kq)("",!0),(0,a._)("div",tt,[(0,a._)("div",nt,[(0,a._)("button",{disabled:"undefined"===typeof e.graph,onClick:r[3]||(r[3]=e=>g())},"Undo",8,ot)]),(0,a._)("div",at,[(0,a._)("button",{disabled:"undefined"===typeof e.graph,onClick:r[4]||(r[4]=e=>h())},"Redo",8,st)]),(0,a._)("div",lt,[(0,a._)("button",{disabled:"undefined"===typeof e.graph,onClick:r[5]||(r[5]=e=>p())},"Clear",8,rt)]),(0,a._)("div",it,[(0,a._)("button",{class:"bg-blue-200",disabled:"undefined"===typeof e.graph,onClick:r[6]||(r[6]=e=>(0,l.SU)(s).open())},"Import",8,dt)]),(0,a._)("div",ct,[(0,a._)("button",{class:"bg-blue-200",disabled:"undefined"===typeof e.graph,onClick:r[7]||(r[7]=e=>u())},"Load default example",8,ut)])])],64))}});const ht=gt;var pt=ht;const mt={class:"block font-semibold mb-1 text-red-900"},bt={class:"list-disc list-inside"},_t={key:1,class:"block text-sky-800"};var ft=(0,a.aZ)({__name:"GraphValidationErrors",props:{formatted_validation_errors:{}},setup(e){const t=e;return(e,n)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,s.C_)(["overflow-hidden rounded-lg border hover:shadow-sm transition ease-in-out mt-4 mb-2 py-2 px-4",{"bg-red-50 border-red-900/20 hover:border-red-900/30":t.formatted_validation_errors.length>0,"bg-sky-100/10 border-sky-900/20 hover:border-sky-900/30":!(t.formatted_validation_errors.length>0)}])},[t.formatted_validation_errors.length>0?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("span",mt,"There are "+(0,s.zw)(t.formatted_validation_errors.length)+" errors in your graph",1),(0,a._)("ul",bt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.formatted_validation_errors,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:"validation-error text-red-800",key:t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e},[e.__v_isVNode?((0,a.wg)(),(0,a.j4)((0,a.LL)(e),{key:0})):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,s.zw)(e),1)],64))],64)))),128))])))),128))])],64)):((0,a.wg)(),(0,a.iD)("span",_t,"Graph contains no errors"))],2))}});const vt=ft;var yt=vt;n(7229),n(5155),n(3422);function wt(e,t,n="text/plain"){const o=document.createElement("a");o.style.display="none",document.body.appendChild(o),o.href=window.URL.createObjectURL(new Blob([t],{type:n})),o.setAttribute("download",e),o.click(),window.URL.revokeObjectURL(o.href),document.body.removeChild(o)}var xt=n(8764);const kt={decode:e=>{const t=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;if(!t.test(e))throw Error("Input is not base64");return xt.lW.from(e,"base64").toString("binary")},encode:e=>xt.lW.from(e,"binary").toString("base64")};var Ct=kt;const Dt={class:"mb-4"},jt=(0,a._)("h1",{class:"text-4xl font-serif inline"},"GraphDoc",-1),Ot=(0,a._)("a",{class:"inline-flex self-center ml-3",title:"GitHub",href:"https://github.com/maastrichtlawtech/graphdoc",target:"_blank"},[(0,a._)("svg",{class:"svg-github",fill:"#1B1F23",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[(0,a._)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z",transform:"scale(64)"})])],-1),St={key:0,class:"text-sm text-slate-900"},$t=(0,a.uE)('<p class="mt-2"> This tool serves as a PoC to convert flowcharts (which can be represented as directed acyclic graphs) to Docassemble interviews. The goal of this tool is to provide an intuitive interface for constructing Docassemble interviews, in which relations and dependencies between nodes (&#39;blocks&#39;) are more clearly visible. </p><h2 class="text-lg font-serif mt-2 mb-1">Instructions</h2><p class="mb-1"> Start by dragging nodes from the left sidebar. Connect nodes by dragging edges from and to the ports of the nodes. Configure nodes and edges by clicking on their cells and filling in the details in the config sidebar on the right. Nodes and edges can also be removed from this sidebar. If no output is produced, interpret the validation errors presented above the Docassemble output window. </p><p class="mb-1"> For an example of a well-structured graph in GraphDoc, click on &#39;Load example&#39;. </p><h2 class="text-lg font-serif mt-2 mb-1">Backup and publish</h2><p> When your graph is complete, you can copy or download the contents of the Docassemble interview configuration file. These contents can be tested in the Docassemble Playground, by pasting the contents in the <a class="styled" href="https://docassemble.org/docs/playground.html#interview_files" target="_blank">YAML editor</a>. By default, the bottom of the generated interview contains a backup of the constructed graph in JSON. You can import the graph by clicking on &#39;Import&#39; in the toolbar and pasting or uploading the generated interview, or just appended JSON portion of the interview. </p>',6),Ut=[$t],Et={class:"overflow-hidden rounded-lg border border-slate-900/20 hover:shadow-sm hover:border-slate-900/30 transition ease-in-out"},At={class:"w-full bg-gray-100"},Ht={class:"w-full flex",style:{height:"500px"}},Mt={class:"w-20 flex-initial bg-gray-100 border-t border-gray-200"},Nt=(0,a._)("div",{id:"modeler-container-box",class:"flex flex-grow border-b-0 border-gray-300/90",style:{"border-width":"3px"}},[(0,a._)("div",{id:"modeler-container",style:{flex:"1"}})],-1),Pt={class:"w-64 flex-initial bg-gray-100 border-t border-gray-200 overflow-y-auto"},Tt={class:"my-4"},It=(0,a._)("span",{class:"text-lg block mb-1"},"Docassemble interview output",-1),Lt={class:"text-sm text-gray-700"},Zt={class:"relative"},Yt={class:"w-full min-h-4 font-mono border rounded p-2 mt-1 whitespace-pre-wrap",id:"docassemble_out_container"},qt={class:"actions"},zt=["disabled"],Rt=(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),Bt=[Rt],Gt=["disabled"],Vt={class:"block mt-4 mb-2","aaav-if":"docassemble_out_options.include_url_export"},Jt=(0,a._)("span",{class:"text-gray-800 text-sm"},"Sharable URL to this graph:",-1),Ft=["value"];var Wt=(0,a.aZ)({__name:"GraphModeler",setup(e){const t=(0,l.iH)(!1),n=(0,r.pm)();(0,a.bv)((()=>{D(),f(),(0,a.Y3)((()=>_()))}));(0,l.iH)({});const d=(0,l.iH)(),c=(0,l.iH)();function u(e){"undefined"!==typeof e&&(c.value=e,d.value?.select(e),d.value?.scrollToCell(e))}const g=(0,l.iH)([]),h=(0,l.iH)([]),p=(0,l.iH)(""),m=(0,l.iH)(""),b=(0,l.qj)({include_json_export:!0,include_url_export:!1});(0,a.YP)((()=>b),(e=>{f()}),{deep:!0});const _=()=>{if(0===location.hash.length)return;const e=location.hash.substring(1);let t="";try{t=Ct.decode(e)}catch{return n.error("Base64-encoded graph in URL couldn't be decoded."),void console.log(e)}let o={};try{if(!t.length)throw Error();if(o=JSON.parse(t),!o)throw Error()}catch(s){return void n.error("Data does not contain valid JSON, or does not contain the GraphDoc boundary specifier.")}if(!Object.hasOwnProperty.call(o,"main")||!Object.hasOwnProperty.call(o,"nodes")||!Object.hasOwnProperty.call(o,"edges"))return void n.error("Data does not include one of the required properties: 'main', 'nodes' or 'edges'.");const a=(new Re).in_json(o).out_antv();d.value.fromJSON(a),f(),n.success("Successfully imported")},f=()=>{if("undefined"==typeof d.value)return;const e=(new Re).in_antv(d.value);if(g.value=(new Ze).validate_graph(e.graph),d.value.getCells().forEach((e=>"undefined"!==typeof e.getData()?.errors&&e.setData({errors:!1},{no_da_update:!0}))),h.value=g.value.map((e=>e.map((e=>{if("string"===typeof e)return e;if(e.is_node()){const t=e,n=d.value?.getCellById(t.id);return"undefined"!==typeof n?(n.setData({errors:!0},{no_da_update:!0}),(0,a.h)("span",{onClick(){u(n)},class:"clickable-entity"},t.get_variable())):`"${t.get_variable()}""`}if(e.is_edge()){const t=e,n=d.value?.getCellById(t.id),o=t.gd.content?`with content ${t.gd.content}`:`leaving from node ${t.get_node_from().get_label()}`;return"undefined"!==typeof n?(0,a.h)("span",{onClick(){u(d.value?.getCellById(t.gd.content?t.id:t.node_from_id))},class:"clickable-entity"},o):`"${o}"`}return""})))),0==h.value.length?(p.value=e.out_docassemble(),p.value&&b.include_json_export&&(p.value=p.value.concat("\n---\n# [START INLINE GRAPHDOC EXPORT]").concat("\n# ").concat(JSON.stringify(e.out_json())).concat("\n# [END INLINE GRAPHDOC EXPORT]"))):p.value="-",0==h.value.length){const e=(new Re).in_antv(d.value),t=Ct.encode(JSON.stringify(e.out_json()));m.value=`${window.location.href.split("#")[0]}#${t}`}else m.value="-"},v=(0,l.iH)("COPY"),x=()=>{const e=document.getElementById("docassemble_out_container");e&&(window.getSelection()?.selectAllChildren(e),navigator.clipboard.writeText(p.value).then((()=>{v.value="COPIED!",setTimeout((()=>{v.value="COPY"}),1200)})).catch((e=>{v.value="FAILED",setTimeout((()=>{v.value="COPY"}),1200),console.log("Failed to copy",e)})))},k=()=>{wt("interview.yml",p.value)},C=e=>{e.on("cell:change:*",(e=>{e.options.no_da_update||("target"==e.key?typeof e.current.cell!=typeof e.previous.cell&&f():["target","zIndex","tools","position"].includes(e.key)||f())})),e.on("node:moved",f),e.on("cell:removed",f),e.on("cell:added",f),e.on("cell:selected",(({cell:e,options:t})=>{c.value!=e&&(c.value=e)})),e.on("cell:unselected",(({cell:e,options:t})=>{null!=c.value&&(c.value=void 0)})),e.on("blank:click",(({e:e,x:t,y:n})=>{null!=c.value&&(c.value=void 0)}))},D=()=>{const e=document.getElementById("modeler-container");d.value=new i.kJ({...y,container:e,autoResize:!0}),void 0!=d.value&&(w(d.value),C(d.value),f())};return(e,n)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",Dt,[(0,a._)("span",null,[jt,Ot,(0,a._)("button",{onClick:n[0]||(n[0]=e=>t.value=!t.value),class:"font-normal underline-offset-4 underline hover:no-underline ml-4 py-1 px-2 text-gray-600 hover:text-gray-900"},"read "+(0,s.zw)(t.value?"less":"more"),1)]),t.value?((0,a.wg)(),(0,a.iD)("div",St,Ut)):(0,a.kq)("",!0)]),(0,a._)("div",Et,[(0,a._)("div",At,[(0,a.Wm)(pt,{graph:d.value,docassemble_cont_update:f,init_modeler:D},null,8,["graph"])]),(0,a._)("div",Ht,[(0,a._)("div",Mt,[null!==d.value?((0,a.wg)(),(0,a.j4)(Ie,{key:0,graph:d.value},null,8,["graph"])):(0,a.kq)("",!0)]),Nt,(0,a._)("div",Pt,[(0,a.Wm)(He,{cell:c.value},null,8,["cell"])])])]),(0,a.Wm)(yt,{formatted_validation_errors:h.value},null,8,["formatted_validation_errors"]),(0,a._)("div",Tt,[It,(0,a._)("label",Lt,[(0,a.wy)((0,a._)("input",{type:"checkbox",class:"mr-1","onUpdate:modelValue":n[1]||(n[1]=e=>b.include_json_export=e)},null,512),[[o.e8,b.include_json_export]]),(0,a.Uk)(" Include a copy of the model ")]),(0,a._)("div",Zt,[(0,a._)("div",Yt,(0,s.zw)(p.value),1),(0,a._)("div",qt,[(0,a._)("button",{onClick:n[2]||(n[2]=e=>k()),title:"Download YAML file",disabled:h.value.length>0},Bt,8,zt),(0,a._)("button",{onClick:n[3]||(n[3]=e=>x()),title:"Copy YMAL content",disabled:h.value.length>0},(0,s.zw)(v.value),9,Gt)]),(0,a._)("label",Vt,[Jt,(0,a._)("input",{type:"text",readonly:"",class:"w-full min-h-4 text-sm font-mono border border-gray-200 text-gray-800 rounded p-2 mt-1",onFocus:n[4]||(n[4]=e=>e.target.select()),value:m.value},null,40,Ft)])])])],64))}});const Kt=Wt;var Xt=Kt;const Qt={class:"mb-8 mt-4 mx-auto max-w-6xl"};var en=(0,a.aZ)({__name:"App",setup(e){return(e,t)=>((0,a.wg)(),(0,a.iD)("div",Qt,[(0,a.Wm)(Xt)]))}});const tn=en;var nn=tn;n(1760);(0,o.ri)(nn).use(r.ZP,{closeOnClick:!1,draggable:!1}).mount("#app")},4857:function(){}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,s){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],s=e[c][2];for(var r=!0,i=0;i<o.length;i++)(!1&s||l>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(r=!1,s<l&&(l=s));if(r){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[o,a,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,s,l=o[0],r=o[1],i=o[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(i)var c=i(n)}for(t&&t(o);d<l.length;d++)s=l[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},o=self["webpackChunkGraphDoc"]=self["webpackChunkGraphDoc"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2006)}));o=n.O(o)})();
//# sourceMappingURL=app.d5d0b42f.js.map